<!DOCTYPE html>
<html>
<head>
	<meta charset="ISO-8859-1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Iron Horse - CyBss Web GUI</title>
	
	<link rel="stylesheet" href="css/bootstrap/3.2.0/bootstrap.min.css">
	<script src="js/jquery/1.11.3/jquery.min.js"></script>
	<script src="js/bootstrap/3.3.4/bootstrap.min.js"></script> 
	<script src="js/angularjs/1.3.15/angular.min.js"></script>   
</head>
<body>
<div class="container-fluid" ng-app="setupApp" ng-controller="setupCtrl">
	<div class="page-header" ng-include="'includes/header.html'"></div>
	<div class="well well-sm">
		<span>Setup</span>	
	</div>
	<form novalidate name="setup" id="setup" class="form-horizontal" role="form" method="post">
		<div class="form-group">
			<label class="col-sm-1 control-label">Core URL</label>
			<div class="col-sm-5">
				<input class="form-control" name="url" id="url" type="url" ng-model="url" required/>
				<span class="help-block" ng-show="setup.url.$error.required">Core URL is required.</span>
      			<span class="help-block" ng-show="setup.url.$error.url">Invalid URL.</span>
      		</div>
		</div>
		
		<div class="form-group" ng-show="errorMessage">
	    <label class="col-sm-1 control-label">Error</label>
	    <div class="col-sm-9">
	    	<div class="alert alert-danger">
          		<strong>Danger!</strong> Indicates a dangerous or potentially negative action.
        	</div>
			<!-- 	    	
	        <textarea class="form-control" rows="5" ng-model="errorMessage" readonly></textarea>
	        -->
	    </div>
		</div>
	
		<button type="button" class="btn btn-default" ng-click="onSubmit()">Submit</button>
		<button type="button" class="btn btn-default" ng-click="onTest()">Test</button>
	
	</form>
	
	<script>
       var app = angular.module('setupApp', []);
       
       app.controller('setupCtrl', function($scope, $http) {
       	  
    	   if (typeof(Storage) !== "undefined") 
    		   $scope.url=localStorage.getItem("org.cysoft.bss.ih.coreurl");
    	   else 
    	       alert("Local storage isn't supported !");
    		
       	   
       	 $scope.onSubmit = function() {
       		 if ($scope.setup.$valid){
       			 
       			if (typeof(Storage) !== "undefined") 
       	    		localStorage.setItem("org.cysoft.bss.ih.coreurl", $scope.url); 
       			else 
         	       alert("Local storage isn't supported !");
         		 
       			$("#setup").attr("action","logOn.html");
       		 	$("#setup").submit();
       		 }
       	 }
       
       	 $scope.onTest = function() {
      		 alert("OnTest !");
      	 }
      
       });
       
 	</script>    

</div>
</body>
</html>