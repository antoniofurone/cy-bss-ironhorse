<!DOCTYPE html>
<html>
<head>
	<meta charset="ISO-8859-1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Iron Horse - CyBss Web GUI</title>
	
	<link rel="stylesheet" href="css/bootstrap/3.2.0/bootstrap.min.css">
	<script src="js/jquery/1.11.3/jquery.min.js"></script>
	<script src="js/bootstrap/3.3.4/bootstrap.min.js"></script> 
	<script src="js/angularjs/1.3.15/angular.min.js"></script>   
	<script src="js/angular-translate/2.8.1/angular-translate.min.js"></script>   
	
	<script src="js/ironhorse-common.js"></script> 
	<script src="js/ironhorse-transl.js"></script>  
	
</head>
<body>
<div class="container-fluid" ng-app="setupApp" ng-controller="setupCtrl">
	<div class="page-header" ng-include="'includes/header.html'"></div>
	<div class="well well-sm">
		<span>Setup</span>	
	</div>
	<form novalidate name="setup" id="setup" class="form-horizontal" role="form" method="post">
		<div class="form-group">
			<label class="col-sm-1 control-label">Core URL</label>
			<div class="col-sm-5">
				<input class="form-control" name="url" id="url" type="url" ng-model="url" required/>
				<span class="help-block" ng-show="setup.url.$error.required" translate>CORE.URL.REQUIRED</span>
      			<span class="help-block" ng-show="setup.url.$error.url" translate>URL.INVALID</span>
      		</div>
		</div>
		
		<div class="form-group" ng-show="errorMessage">
		    <label class="col-sm-1 control-label">Error</label>
		    <div class="col-sm-9">
		    	<div class="alert alert-danger">
	          		{{ errorMessage }}
	        	</div>
			</div>
		</div>
			
		<button type="button" class="btn btn-default" ng-click="onSubmit()">{{'SUBMIT.BUTTON' | translate }}</button>
		<button type="button" class="btn btn-default" ng-click="onTest()" translate>TEST.BUTTON</button>
	
	</form>
	
	<script>
       
	   var app=angular.module('setupApp', ['pascalprecht.translate','irtranslator'])
	   	.config(function($translateProvider) {
	     	$translateProvider
	     	.translations('en',{
    		    'SUBMIT.BUTTON':'Submit',
    		    'TEST.BUTTON': 'Test',
    		    'CORE.URL.REQUIRED': 'Core URL is required.',
    		    'URL.INVALID': 'Invalid URL.'
    		  })
    		  
    		.translations('it',{
    		    'SUBMIT.BUTTON':'Conferma',
    		    'TEST.BUTTON': 'Test',
    		    'CORE.URL.REQUIRED': 'Core URL è obbligatorio.',
    		    'URL.INVALID': 'URL non valido.'
    		  });
	     
	    	 $translateProvider.preferredLanguage(getLanguage());
	 	});
	   
       app.controller('setupCtrl', function($scope, $http,$translate) {
       	  
    	  var storedUrl=getLocalStorageItem("org.cysoft.bss.ih.coreurl");
    	  if (storedUrl!='undefined')
    	  	$scope.url=getLocalStorageItem("org.cysoft.bss.ih.coreurl"); 
    	  
    	  //$translate('SUBMIT_BUTTON')
          //.then(function (translatedValue) {
              //alert(translatedValue);
          //});  
       	   
       	 $scope.onSubmit = function() {
       		 if ($scope.setup.$valid){
       			 
       			setLocalStorageItem("org.cysoft.bss.ih.coreurl",$scope.url);
       			 
       			$("#setup").attr("action","logOn.html");
       		 	$("#setup").submit();
       		 }
       	 }
       
       	 $scope.onTest = function() {
      		 alert("OnTest !");
      	 }
       	 
       	   	
       });
       
       setLocalStorageItem("org.cysoft.bss.ih.user.role", "undefined");
	   setMenuCntl(app);
       
 	</script>    
</div>
</body>
</html>