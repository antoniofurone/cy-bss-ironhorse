<!DOCTYPE html>
<html>
<head>
	<meta charset="ISO-8859-1">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Iron Horse - Menu'</title>
	
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<script src="js/jquery/1.11.3/jquery.min.js"></script>
	<script src="js/bootstrap.min.js"></script> 
	<script src="js/angularjs/1.3.15/angular.min.js"></script>
	<script src="js/angular-translate/2.8.1/angular-translate.min.js"></script>
	
	<script src="js/ironhorse-common.js"></script>
	<script src="js/ironhorse-transl.js"></script>
	   
</head>
<body>
<div class="container-fluid" ng-app="pageApp" ng-controller="pageCtrl">
	<div class="page-header" ng-include="'includes/header.html'" ></div>
	
	<form novalidate name="index" id="index" class="form-horizontal" role="form" method="post">
	
	<div class="form-group" ng-show="!errorMessage">
		<div class="col-sm-4">
				<div class="alert alert-info">
		   			{{'LABEL.CIAO' | translate }} <strong>{{ user.name }}</strong>! <br>
	        		{{'LABEL.YOUR_ROLE' | translate }} <strong>{{ user.role }}</strong>
	        	</div>
	    </div>
	</div>
	
	<div class="form-group" ng-show="errorMessage">
	    <div class="col-sm-9">
	    	<div class="alert alert-danger">
          		{{ errorMessage }}
        	</div>
		</div>
	</div>
		
	</form>

</div>

<script>
	
	var app = angular.module('pageApp', ['pascalprecht.translate','irtranslator'])
		.config(function($translateProvider) {
	     	$translateProvider
	     	.translations('en',{
    		    'LABEL.CIAO':'Hi',
    		    'LABEL.YOUR_ROLE':"Your role is"
    		  })
    		  
    		.translations('it',{
    			'LABEL.CIAO':'Ciao',
    			'LABEL.YOUR_ROLE':"Il tuo ruolo e'"
    		  });
	     	
	     	 $translateProvider.preferredLanguage(getLanguage());
	 	});
	   

	app.controller('pageCtrl', function($scope, $http,$translate) {
	
		$scope.securityToken=getLocalStorageItem("org.cysoft.bss.ih.securityToken");
		
		var user_id=getLocalStorageItem("org.cysoft.bss.ih.user.id");
		
		callRestWs($http,'user/'+user_id+'/get','GET',
				{"Security-Token": $scope.securityToken},
				{},
				function(response){
						if (response.data.resultCode==RESULT_OK){
							$scope.user=response.data.user;
						}
						else
						{
							manageError($scope,response.data.resultCode,response.data.resultDesc);
						}
					}, 
					function(response){
							manageError($scope,response.status,response.data);
					});

 	});   
	   
	setMenuCntl(app);
		

</script>


</body>
</html>